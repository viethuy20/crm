@using Resources
@model PQT.Web.Models.LeadModelView

@{
    ViewBag.MenuBarColl = true;
    ViewBag.Title = "Call List";
}
<section>
    <div class="row">
        <div class="col-lg-12">
            <h1 class="text-primary" style="color: @Model.Event.BackgroundColor">@ViewBag.Title</h1>
        </div><!--end .col -->
        <div class="col-lg-8">
            <article class="margin-bottom-xxl">
                <p class="lead" style="margin-bottom: 5px;">@Model.Event.EventName</p>
                <p><b>Event Code: </b>@Model.Event.EventCode <b>Start Date:</b> @Model.Event.StartDate.ToString("dd/MM/yyyy") <b>End Date:</b> @Model.Event.EndDate.ToString("dd/MM/yyyy")</p>
            </article>
        </div>
    </div>
    <div class="row">
        <div class="col-md-7">
            <div class="card  card-underline">
                <div class="card-head">
                    <div class="tools">
                        <div class="btn-group">
                            <a href="@Url.Action("CallSheet",new{eventId=Model.Event.ID,leadId=Model.Event.ID})" class="btn btn-icon-toggle text-success simple-ajax-popup-align-top" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Start New Call"><i class="fa fa-phone-square fa-2x"></i></a>
                        </div>
                    </div>
                    <header><i class="fa fa-fw fa-phone"></i> My Call List</header>
                </div><!--end .card-head -->
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table" id="tableLead">
                            <thead>
                                <tr>
                                    <th>Date Created</th>
                                    <th>Country</th>
                                    <th>Company</th>
                                    <th>Client Name/Job Title</th>
                                    <th>Direct Line/Mobile number</th>
                                    <th>Call Back</th>
                                    <th></th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div><!--end .card-body -->
            </div><!--end .card -->
        </div>

        <div class="col-md-5">
            <div class="card card-bordered style-primary" style="background-color: @Model.Event.BackgroundColor;border-color:@Model.Event.BackgroundColor">
                <div class="card-head">
                    @*<div class="tools">
                            <div class="btn-group">
                                <div class="btn-group">
                                    <a href="#" class="btn btn-icon-toggle dropdown-toggle" data-toggle="dropdown"><i class="md md-colorize"></i></a>
                                    <ul class="dropdown-menu animation-dock pull-right menu-card-styling" role="menu" style="text-align: left;">
                                        <li><a href="javascript:void(0);" data-style="style-default-dark"><i class="fa fa-circle fa-fw text-default-dark"></i> Default dark</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-default"><i class="fa fa-circle fa-fw text-muted"></i> Default</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-default-light"><i class="fa fa-circle fa-fw text-default-light"></i> Default light</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-default-bright"><i class="fa fa-circle fa-fw text-default-bright"></i> Default bright</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-primary-dark"><i class="fa fa-circle fa-fw text-primary-dark"></i> Primary dark</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-primary"><i class="fa fa-circle fa-fw text-primary"></i> Primary</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-primary-light"><i class="fa fa-circle fa-fw text-primary-light"></i> Primary light</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-primary-bright"><i class="fa fa-circle fa-fw text-primary-bright"></i> Primary bright</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-accent-dark"><i class="fa fa-circle fa-fw text-accent-dark"></i> Accent dark</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-accent"><i class="fa fa-circle fa-fw text-accent"></i> Accent</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-accent-light"><i class="fa fa-circle fa-fw text-accent-light"></i> Accent light</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-accent-bright"><i class="fa fa-circle fa-fw text-accent-bright"></i> Accent bright</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-danger"><i class="fa fa-circle fa-fw text-danger"></i> Danger</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-warning"><i class="fa fa-circle fa-fw text-warning"></i> Warning</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-success"><i class="fa fa-circle fa-fw text-success"></i> Success</a></li>
                                        <li><a href="javascript:void(0);" data-style="style-info"><i class="fa fa-circle fa-fw text-info"></i> Info</a></li>
                                    </ul>
                                </div>
                                <a class="btn btn-icon-toggle btn-refresh"><i class="md md-refresh"></i></a>
                                <a class="btn btn-icon-toggle btn-collapse"><i class="fa fa-angle-down"></i></a>
                                <a class="btn btn-icon-toggle btn-close"><i class="md md-close"></i></a>
                            </div>
                        </div>*@
                    <header><i class="fa fa-fw fa-tag"></i> NCL</header>
                </div><!--end .card-head -->
                <div class="card-body style-default-bright">
                    <div class="table-responsive">
                        <table class="table" id="tableNCList">
                            <thead>
                                <tr>
                                    <th>Date Created</th>
                                    <th>Sales</th>
                                    <th>Country</th>
                                    <th>Organisation</th>
                                    <th>Role</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div><!--end .card-body -->
            </div><!--end .card -->
        </div>
    </div>
</section>


@Html.Script(
    @<script>

        var oTable = $("#tableLead");
        oTable.dataTable({
            "processing": true, // for show progress bar
            "serverSide": true, // for process server side
            "filter": true, // this is for disable filter (search box)
            "orderMulti": false, // for disable multiple column at once
            "stateSave": false,
            "ajax": {
                "url": "@Url.Action("AjaxGetLeads")?eventId=@Model.Event.ID",
                "type": "POST",
                "datatype": "json",
                "data": function (d) {
                }
            },
            "columns": [
                { "data": "CreatedTime", "name": "CreatedTime", "orderable": true },
                { "data": "Country", "name": "Country", "orderable": true },
                { "data": "Company", "name": "Company", "orderable": true },
                { "data": "ClientName", "name": "ClientName", "orderable": true },
                { "data": "DirectLine", "name": "DirectLine", "orderable": true },
                { "data": "CallBackDate", "name": "CallBackDate", "orderable": true },
                { "data": "ID", "name": "ID", "orderable": false },
            ],
            "iDisplayLength": 25,
            "aaSorting": [[0, "desc"]],
            "fnRowCallback": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                @*$(nRow).find('td:eq(1)').attr("style", "text-align:center");
                $(nRow).find('td:eq(4)').html('<a href="@Url.Action("Detail","Audit")/' + aData["ID"] + '" target="_blank"><i class="md md-more"></i></a>');*@
                var dropdowns = '<li><a class="simple-ajax-popup-align-top" href="@Url.Action("CallingForm")?leadId=' + aData["ID"] + '"><span class=" text-primary"><i class="fa fa-fw fa-phone"></i> Start Call</span></a></li>';
                $(nRow).find('td:eq(6)').html('<div class="dropdown"><a class="btn dropdown-toggle btn-default btn-mini btn btn-flat prepend-icon" data-toggle="dropdown" href="#"><i class="fa fa-navicon"></i> <span class="caret"></span></a><ul class="pull-right dropdown-menu">' +
                    dropdowns +
                    '</ul></div>');
            },
            initComplete: function () {
                var _table = this;
                _table.parent().find('input[type="search"]').unbind();
                var timeOutTyping;
                _table.parent().find('input[type="search"]').bind('keyup', function (e) {
                    clearTimeout(timeOutTyping);
                    timeOutTyping = setTimeout(function () {
                        _table.fnFilter(_table.parent().find('input[type="search"]').eq(0).val());
                    }, 600);
                });
            },
        });
        var nclTable = $("#tableNCList");
        nclTable.dataTable({
            "processing": true, // for show progress bar
            "serverSide": true, // for process server side
            "filter": true, // this is for disable filter (search box)
            "orderMulti": false, // for disable multiple column at once
            "stateSave": false,
            "ajax": {
                "url": "@Url.Action("AjaxGetNCList")?eventId=@Model.Event.ID",
                "type": "POST",
                "datatype": "json",
                "data": function (d) {
                }
            },
            "columns": [
                { "data": "CreatedTime", "name": "CreatedTime", "orderable": true },
                { "data": "Salesman", "name": "Salesman", "orderable": true },
                { "data": "Country", "name": "Country", "orderable": true },
                { "data": "Company", "name": "Company", "orderable": true },
                { "data": "ClientName", "name": "ClientName", "orderable": true },
                { "data": "StatusDisplay", "name": "StatusDisplay", "orderable": true },
            ],
            "iDisplayLength": 100,
            "aaSorting": [[0, "desc"]],
            "fnRowCallback": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                @*$(nRow).find('td:eq(1)').attr("style", "text-align:center");
                $(nRow).find('td:eq(4)').html('<a href="@Url.Action("Detail","Audit")/' + aData["ID"] + '" target="_blank"><i class="md md-more"></i></a>');*@
            },
            initComplete: function () {
                var _table = this;
                _table.parent().find('input[type="search"]').unbind();
                var timeOutTyping;
                _table.parent().find('input[type="search"]').bind('keyup', function (e) {
                    clearTimeout(timeOutTyping);
                    timeOutTyping = setTimeout(function () {
                        _table.fnFilter(_table.parent().find('input[type="search"]').eq(0).val());
                    }, 600);
                });
            },
        });

        ////Select username event
        //$('#userfilter').change(function () {
        //    oTable.fnDraw();
        //});
        //$('#btnSearch').click(function () {
        //    oTable.fnDraw();
        //});




    </script>
                         )
